import{INVALID_CONFIG as i}from"@liff/consts";import{logger as e}from"@liff/logger";import{hexToBase64 as o,randomAlphaNumericString as r,createLiffError as t,qs as f}from"@liff/util";import{getConfig as n,setLoginTmp as l}from"@liff/store";import{getEndPoint as p}from"@liff/server-api";import{getVersion as c}from"@liff/get-version";import{isSubWindow as s}from"@liff/is-sub-window";import{isInClient as m}from"@liff/is-in-client";import a from"tiny-sha256";import{SyncHook as d}from"@liff/hooks";var u=function(){function u(){this.hooks={before:new d}}return Object.defineProperty(u.prototype,"name",{get:function(){return"login"},enumerable:!1,configurable:!0}),u.prototype.install=function(){return this.login.bind(this)},u.prototype.login=function(d){this.hooks.before.call(d);var u=r(43),g=o(a(u)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),h=n();if(!h||!h.liffId)throw t(i,"You need to define `liffId` for liff.login()");var _={app_id:h.liffId,state:r(12),response_type:"code",code_challenge_method:"S256",code_challenge:g,liff_sdk_version:c()};d&&d.redirectUri&&(_.redirect_uri=d.redirectUri),s()&&!m()&&(_.disable_auto_login="true"),l({codeVerifier:u});var b=p("authorize")+"?"+f.stringify(_);e.debug("[Redirect] "+b),window.location.href=b},u}();export{u as LoginModule};
