"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@liff/consts"),i=require("@liff/logger"),r=require("@liff/util"),o=require("@liff/store"),t=require("@liff/server-api"),n=require("@liff/get-version"),f=require("@liff/is-sub-window"),l=require("@liff/is-in-client"),u=require("tiny-sha256"),s=require("@liff/hooks");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c=a(u);var d=function(){function u(){this.hooks={before:new s.SyncHook}}return Object.defineProperty(u.prototype,"name",{get:function(){return"login"},enumerable:!1,configurable:!0}),u.prototype.install=function(){return this.login.bind(this)},u.prototype.login=function(u){this.hooks.before.call(u);var s,a=r.randomAlphaNumericString(43),d=(s=a,r.hexToBase64(c.default(s)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")),g=o.getConfig();if(!g||!g.liffId)throw r.createLiffError(e.INVALID_CONFIG,"You need to define `liffId` for liff.login()");var p={app_id:g.liffId,state:r.randomAlphaNumericString(12),response_type:"code",code_challenge_method:"S256",code_challenge:d,liff_sdk_version:n.getVersion()};u&&u.redirectUri&&(p.redirect_uri=u.redirectUri),f.isSubWindow()&&!l.isInClient()&&(p.disable_auto_login="true"),o.setLoginTmp({codeVerifier:a});var h=t.getEndPoint("authorize")+"?"+r.qs.stringify(p);i.logger.debug("[Redirect] "+h),window.location.href=h},u}();exports.LoginModule=d;
